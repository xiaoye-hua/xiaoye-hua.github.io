I"÷%<h1 id="build-in-modules">Build In Modules</h1>
<h2 id="sorted-å­—å…¸">sorted å­—å…¸</h2>
<p><a href="https://blog.csdn.net/tangtanghao511/article/details/47810729">Blog Ref</a></p>

<h2 id="get-unique-value-from-list-of-list">get unique value from list of list</h2>
<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span>  <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">]</span>
<span class="nb">set</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="c1"># TypeError: unhashable type: 'list'
</span>
<span class="c1"># è§£å†³åŠæ³•
# è½¬åŒ–ä¸ºtupleï¼Œtupleæ˜¯hashableçš„
</span><span class="n">a</span>  <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
    <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">]</span>
<span class="nb">set</span><span class="p">(</span>
 <span class="nb">tuple</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> 
<span class="p">)</span>
</code></pre></div></div>
<h2 id="numpy-list--list-çš„ä¸åŒ">numpy list +, list +çš„ä¸åŒ</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>a = np.array([1, 2])
b = np.array([2, 3])
a+ b
# np.array([3, 5])
a = [1, 2]
b = [2, 3]
a + b
# [1, 2, 2, 3]

</code></pre></div></div>

<h2 id="import-é—®é¢˜">import é—®é¢˜</h2>
<p>åœ¨pythoné¡¹ç›®ä¸­ä¼šå‡ºç°åŒ…çš„å¼•ç”¨é—®é¢˜ï¼Œ å¦‚ä¸‹ä¸ºä»£ç ç»“æ„</p>
<pre><code class="language-mermaid">graph TD
A[Python project] --&gt;B(module)
A --&gt; F(python code)
F --&gt; D(script.py)
B --&gt; C(submodule.py)
B --&gt; E(__init__.py)
</code></pre>
<p>script.py ä¸­ä»£ç å¦‚ä¸‹æ‰èƒ½å¼•ç”¨submoduleä¸­å‡½æ•°</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import sys
sys.path.append('../)
from src.module1 import submodule
</code></pre></div></div>
<p>ç„¶è€Œä»¥ä¸Šä»£ç åªèƒ½åœ¨python project/python code/ ç›®å½•ä¸­æ‰§è¡Œï¼Œå¦‚æœåœ¨å…¶ä»–ç›®å½•è§£å†³åŠæ³•å¦‚ä¸‹ï¼š</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import os
# è·å–æ–‡ä»¶æ‰€åœ¨è·¯å¾„
ROOT_DIR = os.path.abspath(os.path.dirname(__file__))
# ä¿®æ”¹è·¯å¾„åˆ°ç›®æ ‡è·¯å¾„
os.chdir(ROOT_DIR)

import sys
sys.path.append('../)
from src.module1 import submodule
</code></pre></div></div>
<h1 id="third-party-modules">Third Party Modules</h1>
<h2 id="logging">logging</h2>
<h3 id="basicconfig">basicConfig</h3>
<ol>
  <li><a href="https://docs.python.org/3/library/logging.html#logrecord-attributes">format detail information</a></li>
</ol>

<h2 id="os-æ¨¡å—">os æ¨¡å—</h2>

<h3 id="ospathjoin-åœ¨windowså’Œlinuxä¸Šçš„ä¸åŒ">os.path.join() åœ¨windowså’Œlinuxä¸Šçš„ä¸åŒ</h3>
<p><strong>ç»“è®º</strong>: <strong>os.path.join() ä¸­çš„ argument éƒ½ä¸è¦ä»¥â€œ/â€å¼€å¤´</strong></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cwd = os.getcwd()
# 'D:\\code\\winner'
os.path.join(cwd, 'engine')
# 'D:\\code\\winner\\engine' å¯ä»¥ä½¿ç”¨
os.path.join(cwd, '/engine')
# 'D:/engine'  æ— æ³•ä½¿ç”¨
os.path.join(cwd, "/engine/test")
#  'D:/engine/test' æ— æ³•ä½¿ç”¨
os.path.join(cwd, "engine/test")
# 'D:\\code\\winner\\engine/test' å¯ä»¥ä½¿ç”¨
os.path.join(cwd, "engine", "test")
# 'D:\\code\\winner\\engine\\test' å¯ä»¥æ­£å¸¸ä½¿ç”¨
os.path.joiã€n(cwd, "engine", "/test")
#  'D:/test' æ— æ³•æ­£å¸¸ä½¿ç”¨
</code></pre></div></div>
<h3 id="abstract-path">Abstract path</h3>
<p>osè¿”å›å½“å‰æ–‡ä»¶å¤¹çš„ç»å¯¹è·¯å¾„(python é¡¹ç›®ä¸­å¯ç”¨)
ROOT_DIR = os.path.abspath(os.path.dirname(<strong>file</strong>))</p>

<h2 id="pandas">pandas</h2>
<p>csv åˆ†å‰²ç¬¦çš„é—®é¢˜ï¼š â€œ\x01â€ æ ‡è¯†crt+A, æ— æ³•ä»£ç è¾“å…¥ã€‚ä¸å®¹æ˜“é€ æˆæ•°æ®è¯»å–é”™è¯¯</p>

<h2 id="impyla">impyla</h2>
<p>å¯¹äºpython3ï¼Œ ä¸‹é¢impala_config ä¸­portéœ€è¦æ˜¯int</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>from impala.dbapi import connect
from impala.util import as_pandas
import pandas as pd

impala_config = {
    "host": "10.21.130.61",
    "port": 21050,
    "user": "hdfs",
    "auth_mechanism": "GSSAPI",
    "kerberos_service_name": 'impala'
}

hive_config = {
    "host": "10.21.130.61",
    "port": 10000,
    "user": "hdfs",
    "auth_mechanism": "GSSAPI",
    "kerberos_service_name": 'hive'
}


def impala_query(sql):
    conn = connect(**impala_config)
    cur = conn.cursor()
    cur.execute(sql)
    df = as_pandas(cur)
    conn.close()
    return df


def impala_exec(sql):
    conn = connect(**impala_config)
    cur = conn.cursor()
    cur.execute(sql)
    conn.close()


def hive_query(sql):
    conn = connect(**hive_config)
    cur = conn.cursor()
    cur.execute(sql)
    data = cur.fetchall()
    conn.close()
    return pd.DataFrame(data)



def hive_exec(sql):
    conn = connect(**hive_config)
    cur = conn.cursor()
    cur.execute(sql)
    conn.close()
</code></pre></div></div>
<p>å¯¹äº</p>

<h2 id="scipy">scipy</h2>
<h3 id="æ‹Ÿåˆé«˜æ–¯æ›²çº¿å¾—åˆ°mu-std">æ‹Ÿåˆé«˜æ–¯æ›²çº¿ï¼Œå¾—åˆ°mu, std</h3>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import numpy as np
from scipy.stats import norm
import matplotlib.pyplot as plt

# Data
y = np.array([395.27, 399.77, 436.10, 486.60, 561.20, 636.37, 784.90, 917.50, 965.53, 910.87, 897.67, 868.17, 762.93, 647.33, 519.37, 426.73, 375.87])
x = np.array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])

# Find mean and sd
mu, std = norm.fit(y)
</code></pre></div></div>

<h2 id="subprocess">Subprocess</h2>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cmd=''
exit_code = subprocess.call(cmd, shell=True)
</code></pre></div></div>
<p>exit_code å¦‚æœæ˜¯0åˆ™æˆæœï¼Œå¤§äº0åˆ™å¤±è´¥ <a href="http://www.cnblogs.com/vamei/archive/2012/09/20/2694466.html">é“¾æ¥: exit code</a></p>

<h2 id="argparse">argparse</h2>
<p>æ–‡ä»¶1ä¸­æœ‰argparseå‚æ•°ï¼Œå¦‚æœæ–‡ä»¶2ä¸­ä»æ–‡ä»¶1importå‚æ•°ï¼Œåˆ™è¿è¡Œæ–‡ä»¶2çš„æ—¶å€™å‡ºé”™ï¼ŒåŸå› ä¸æ˜ï¼Œè¿˜éœ€ç¡®è®¤</p>

<p>##  opencv, plt</p>

<ol>
  <li>plt.imsave åçš„å›¾ç‰‡ï¼Œ cv2.imread ååƒç´ å·®ä¸€ä¸ªã€‚ æœ€å¥½ä¸€è‡´ã€‚</li>
  <li>opencv å›¾ç‰‡åºåˆ—å’Œååºåˆ—åŒ–æ—¶ï¼Œä¼šå¯¹åƒç´ ç‚¹è¿›è¡Œå››èˆäº”å…¥ï¼Œå¦‚æœå›¾ç‰‡å·²ç»å½’ä¸€åŒ–ï¼Œç„¶åè¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–çš„è¯ï¼Œä¿¡æ¯ä¼šä¸¢å¤± cv2.imencode,   cv2.imdecode</li>
</ol>

<p>## datetime</p>
<ol>
  <li>å°†UTCæ—¶é—´è½¬åŒ–ä¸ºå½“åœ°æ—¶é—´
```python
import pytz</li>
</ol>

<p>local_tz = pytz.timezone(â€˜Europe/Moscowâ€™) # use your local timezone name here</p>
<h1 id="note-pytzreferencelocaltimezone-would-produce-wrong-result-here">NOTE: pytz.reference.LocalTimezone() would produce wrong result here</h1>

<h2 id="you-could-use-tzlocal-module-to-get-local-timezone-on-unix-and-win32">You could use <code class="highlighter-rouge">tzlocal</code> module to get local timezone on Unix and Win32</h2>
<h1 id="from-tzlocal-import-get_localzone---pip-install-tzlocal">from tzlocal import get_localzone # $ pip install tzlocal</h1>

<h1 id="-get-local-timezone"># get local timezone</h1>
<h1 id="local_tz--get_localzone">local_tz = get_localzone()</h1>

<p>def utc_to_local(utc_dt):
local_dt = utc_dt.replace(tzinfo=pytz.utc).astimezone(local_tz)
return local_tz.normalize(local_dt) # .normalize might be unnecessary</p>
<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[åŸå§‹é“¾æ¥](https://stackoverflow.com/questions/4563272/convert-a-python-utc-datetime-to-a-local-datetime-using-only-python-standard-lib/13287083#13287083?newreg=8cc313a2daed43ed82d6900be14ee811)

1. strftime å’Œ strptime
æ€»æ˜¯ææ··ä¸¤è€…åŒºåˆ« 
```python
begin = datetime.datetime.strptime(target_day_str, '%Y-%m-%d').strftime('%Y%m%d')
</code></pre></div></div>

<ul>
  <li>strptime  stringè¯»ä¸ºæ—¥æœŸ</li>
  <li>strftime  å°†æ—¥æœŸè½¬åŒ–ä¸ºæŒ‡å®šæ ¼å¼string</li>
</ul>

<h2 id="matplotlib">matplotlib</h2>
<ol>
  <li>savefigä¸ºè¾“å‡ºæ–‡ä»¶ä¸ºç©ºç™½ <a href="https://blog.csdn.net/u010099080/article/details/52912439">ã€Pythonã€‘è§£å†³ä½¿ç”¨ plt.savefig ä¿å­˜å›¾ç‰‡æ—¶ä¸€ç‰‡ç©ºç™½</a></li>
</ol>

<h2 id="ç¹ä½“ç®€ä½“è½¬æ¢">ç¹ä½“ç®€ä½“è½¬æ¢</h2>

<p><a href="https://blog.csdn.net/u012052268/article/details/77823970">ç¹ä½“ç®€ä½“è½¬åŒ–</a></p>

<h1 id="machine-learning-pipeline">Machine Learning Pipeline</h1>

<h2 id="æ•´ä½“æµç¨‹">æ•´ä½“æµç¨‹</h2>
<ol>
  <li>å·¥ç¨‹åŒ– <a href="https://towardsdatascience.com/structure-and-automated-workflow-for-a-machine-learning-project-2fa30d661c1e">é“¾æ¥</a>,<a href="https://drivendata.github.io/cookiecutter-data-science/#example">cookiecutter</a></li>
  <li>pip
pip æ›´æ–°ç‰ˆæœ¬åŒæ—¶è¦æ›´æ–°setupä¸­çš„ç‰ˆæœ¬å·ï¼Œè¿™æ ·æ‰èƒ½å®‰è£…æœ€æ–°ç‰ˆã€‚</li>
  <li>sphinx è‡ªåŠ¨ç”Ÿæˆæ–‡æ¡£
<a href="https://blog.csdn.net/liqiancao/article/details/65535444">é“¾æ¥</a></li>
</ol>

<h2 id="ç‰¹å¾å·¥ç¨‹">ç‰¹å¾å·¥ç¨‹</h2>
<ol>
  <li>featuretools
<a href="https://towardsdatascience.com/automated-feature-engineering-in-python-99baf11cc219">mediumæ•™ç¨‹</a></li>
</ol>

<h2 id="æ¨¡å‹æ­å»º">æ¨¡å‹æ­å»º</h2>
<ol>
  <li>lightgbm
<a href="https://www.kaggle.com/tobikaggle/humble-lightgbm-starter-with-learning-curve">kaggle æ•™ç¨‹</a></li>
</ol>
:ET